package malwaremanager

import (
	"fmt"
	"net"
)

type ClamAVConfig struct {
	Address string `json:"address"`
}

func (c *ClamAVConfig) GetNormalizedAddress() (string, error) {
	host, port, err := c.parseAddress()
	if err != nil {
		return "", fmt.Errorf("failed to parse address: %w", err)
	}

	return fmt.Sprintf("tcp://%s:%s", host, port), nil
}

func (c *ClamAVConfig) parseAddress() (string, string, error) {
	host, port, err := net.SplitHostPort(c.Address)
	if err != nil {
		return "", "", fmt.Errorf("failed to parse address: %w", err)
	}

	return host, port, nil
}
