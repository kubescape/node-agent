package malwaremanager

import (
	"strings"

	"github.com/prometheus/procfs"
)

func GetCmdlineByPid(pid int) (string, error) {
	fs, err := procfs.NewFS("/proc")
	if err != nil {
		return "", err
	}

	proc, err := fs.Proc(pid)
	if err != nil {
		return "", err
	}

	cmdline, err := proc.CmdLine()
	if err != nil {
		return "", err
	}

	return strings.Join(cmdline, " "), nil
}

func GetParentByPid(pid int) (*procfs.ProcStat, error) {
	fs, err := procfs.NewFS("/proc")
	if err != nil {
		return nil, err
	}

	proc, err := fs.Proc(pid)
	if err != nil {
		return nil, err
	}

	parent, err := proc.Stat()
	if err != nil {
		return nil, err
	}

	return &parent, nil
}
